pipeline {
   agent any

   tools {
   
      // Install the Maven version configured as "M3" and add it to the path.
      maven "M3"
      
   }

   stages {
      stage('Clone and Build') {
         steps {
         script{
           git credentialsId: 'Kirtee-github-private-key', url:'git@github.com:Kamthekirtee/maven-hello-world.git'
           }
            sh "mvn clean compile"
         }
         }
      stage("Test") {
          steps {
            
            sh "mvn clean test"
            
          }

      }
      stage("Deploy") {
          steps {
             
            sh "mvn clean package"
            sh "docker build -t devopsartifactory1.jfrog.io/docker-local ."
            sh "docker push devopsartifactory1.jfrog.io/docker-local"
          }
          post {
              success {
                  archiveArtifacts 'target/*.jar'
              }

          }


      }

      }
   }
